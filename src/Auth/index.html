<!DOCTYPE html>
<html>
  <head>
    <title>Test POST to Google Sheet</title>
  </head>
  <body>
    <h1>Google Sheet API Test</h1>
    <form id="testForm">
      <h1>
        Lưu ý: API này Input ID tự động bằng Username nên Username phải đuợc
        điền
      </h1>
      <input type="text" id="name" placeholder="Name" /><br />
      <input type="text" id="username" placeholder="Username" required /><br />
      <input type="submit" value="Submit" />
    </form>

    <script>
      document
        .getElementById("testForm")
        .addEventListener("submit", function (event) {
          event.preventDefault(); // Prevent default form submission

          var username = document.getElementById("username").value;
          var name = document.getElementById("name").value;

          if (!username) {
            alert("Username is required");
            return;
          }

          var formData = {
            username: username,
            name: name,
          };

          fetch(
            "https://script.google.com/macros/s/AKfycbxowndRf6ULZb7nV94aatKDrtIC-1Hh-PknBsqBVlcUSpNZjxGi62po7h5QXGuPxx3Fhg/exec",
            {
              method: "POST",
              mode: "no-cors",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(formData),
            }
          )
            .then(() => {
              console.log("Data submitted successfully");
              alert("Data submitted successfully");
            })
            .catch((error) => {
              console.error("Error:", error);
              alert("Error submitting data");
            });
        });
    </script>
  </body>
</html>
